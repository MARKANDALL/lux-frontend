/* features/features/tts/tts-overlay.css */
/* The "Rock Solid" Positioning Layer. */
/* REWRITTEN: Right-side Drawer with Left-Protruding Header Tab */

:root {
  --lux-tts-panel-w: 360px;
  --lux-tts-panel-max-w: min(92vw, 380px);
  --lux-tts-panel-max-h: min(520px, 70vh);
  
  --lux-tts-radius: 14px;
  
  /* Tab visuals */
  --lux-tts-tab-h: 34px;
  --lux-tts-tab-protrude: 140px; /* How far it sticks out to the LEFT */
  --lux-tts-tab-peek: 44px;      /* How much of the TAB is visible when closed */
  --lux-tts-box-peek: 8px;       /* How much of the BOX EDGE is visible when closed */
  
  --lux-tts-tab-bg: #2d6cdf;
  --lux-tts-tab-bg-hover: #2457b1;
  --lux-tts-tab-ink: #fff;
}

/* ==========================================================================
   PANEL CONTAINER (Right Side)
   ========================================================================== */
html body .lux-tts-panel {
  position: fixed !important;
  
  /* Anchor Top-Right */
  top: 80px !important; 
  right: 0 !important; /* Pinned to the right edge */
  left: auto !important;
  
  /* Dimensions */
  width: var(--lux-tts-panel-w) !important;
  max-width: var(--lux-tts-panel-max-w) !important;
  height: auto !important;
  
  /* Theme */
  background: #fff !important;
  color: #111 !important;
  
  /* Borders (Rounded Left corners) */
  border: 1px solid rgba(0, 0, 0, 0.06) !important;
  border-right: 0 !important;
  border-top-left-radius: var(--lux-tts-radius) !important;
  border-bottom-left-radius: var(--lux-tts-radius) !important;
  border-top-right-radius: 0 !important;
  border-bottom-right-radius: 0 !important;
  
  /* Depth */
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.18) !important;
  
  /* IMPORTANT: Allow the tab to hang outside (to the left) */
  overflow: visible !important;
  
  /* CLOSED STATE: Slide Right, leaving just the tab peek + box sliver visible */
  /* Calculation: Move 100% right, then pull back by (Tab Peek + Box Peek) */
  transform: translate3d(calc(100% - var(--lux-tts-tab-peek) - var(--lux-tts-box-peek)), 0, 0) !important;
  
  transition: transform 0.28s cubic-bezier(0.2, 0.8, 0.2, 1) !important;
  
  z-index: 2147483647 !important;
  display: block !important;
}

/* OPEN STATE: Slide back to 0 (Fully visible) */
html.lux-tts-open body .lux-tts-panel {
  transform: translate3d(0, 0, 0) !important;
}

/* ==========================================================================
   THE TAB (Full-width header that protrudes Left)
   ========================================================================== */
.lux-tts-tab {
  position: absolute !important;
  top: 6px !important;
  
  /* Stretch Strategy: Pin Right side inside the box, Pin Left side OUTSIDE the box */
  right: 6px !important;
  left: calc(var(--lux-tts-tab-protrude) * -1) !important; 
  width: auto !important; /* Let left/right define width */
  
  height: var(--lux-tts-tab-h) !important;
  
  /* Layout */
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 10px !important;
  
  /* Theme */
  background: var(--lux-tts-tab-bg) !important;
  color: var(--lux-tts-tab-ink) !important;
  border: none !important;
  border-radius: 999px !important;
  
  /* Typography */
  font: 600 14px/1 system-ui, -apple-system, sans-serif !important;
  letter-spacing: 0 !important;
  
  /* Interaction */
  cursor: pointer !important;
  user-select: none !important;
  box-shadow: 0 6px 18px rgba(13, 17, 23, 0.35) !important;
  z-index: 2 !important; /* Above panel content */
  
  padding: 0 16px !important;
  
  /* FIXED: Added 'transform 0.18s ease' here so the !important doesn't kill the movement */
  transition: transform 0.18s ease, background 0.2s ease, padding 0.2s ease, filter 0.18s ease !important;
}

.lux-tts-tab:hover {
  background: var(--lux-tts-tab-bg-hover) !important;
  filter: none !important;
}

/* Icon Rotation */
.lux-tts-tab-icon {
  display: inline-block !important;
  font-size: 14px !important;
  transition: transform 0.25s ease !important;
}

/* Flip arrow when open (Left arrow becomes Right arrow) */
html.lux-tts-open .lux-tts-tab-icon {
  transform: rotate(180deg) !important;
}

/* ==========================================================================
   PANEL BODY (No Scrollbars, Full Visibility)
   ========================================================================== */
.lux-tts-panel #tts-controls {
  /* Push content down so it doesn't overlap the header tab */
  padding: calc(var(--lux-tts-tab-h) + 14px) 16px 16px !important;
  
  /* Allow natural height, NO internal scrolling */
  height: auto !important;
  max-height: none !important;
  overflow: visible !important;
  box-sizing: border-box !important;
}

/* Hide any accidental scrollbars just in case */
.lux-tts-panel #tts-controls::-webkit-scrollbar {
  display: none !important;
}

/* ==========================================================================
   MOBILE TWEAKS
   ========================================================================== */
@media (max-width: 480px) {
  html body .lux-tts-panel {
     width: 90vw !important;
  }
  :root {
    --lux-tts-tab-protrude: 88px; /* Shorter tongue on mobile */
  }
}