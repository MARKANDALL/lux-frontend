@import "./_parts/lux-convo.picker.01-ui-stage.css";

/* ============================================================
   Intro -> Picker “warp” transition (transform-only)
   ============================================================ */
#convoApp.lux-warp .lux-intro{
  animation: luxWarpIntro 360ms cubic-bezier(.18,.9,.2,1) both;
}
#convoApp.lux-warp .lux-scene-cards{
  animation: luxWarpTiles 360ms cubic-bezier(.18,.9,.2,1) both;
}

@keyframes luxWarpIntro{
  0%{ transform: translate3d(0,0,0) scale(1); opacity: 1; }
  100%{ transform: translate3d(0,-10px,0) scale(1.08); opacity: 0; }
}
@keyframes luxWarpTiles{
  0%{ transform: translate3d(0,0,0) scale(1); opacity: 1; }
  100%{ transform: translate3d(0,0,0) scale(1.06); opacity: 0.92; }
}

#convoApp.lux-arrive .lux-picker{
  animation: luxArrivePicker 420ms cubic-bezier(.18,.9,.2,1) both;
}
@keyframes luxArrivePicker{
  0%{ transform: translate3d(0,14px,0) scale(.985); opacity: 0; }
  100%{ transform: translate3d(0,0,0) scale(1); opacity: 1; }
}

@media (prefers-reduced-motion: reduce){
  #convoApp.lux-warp .lux-intro,
  #convoApp.lux-warp .lux-scene-cards,
  #convoApp.lux-arrive .lux-picker{
    animation: none !important;
  }
}


/* ============================================================
   Shared panel chrome (matches Lux “card” language)
   ============================================================ */
.lux-panel{
  background: var(--convo-card);
  border: 1px solid var(--convo-border);
  border-radius: var(--convo-radius-lg);
  overflow: hidden;
  box-shadow: var(--convo-shadow);
}

.lux-hd{
  padding: 12px 14px;
  border-bottom: 1px solid rgba(0,0,0,0.08);
  background: var(--convo-tint);

  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 10px;

  color: var(--convo-ink);
}

.lux-title{
  font-weight: 800;
  letter-spacing: 0.2px;
  color: var(--convo-ink);
}

.lux-sub{
  color: var(--convo-muted);
  font-size: 12px;
}

.lux-body{ padding: 12px 14px; }

.lux-actions{
  display: flex;
  gap: 10px;
  align-items: center;
}


/* ============================================================
   Intro hero (Edge-like)
   ============================================================ */
.lux-heroCard{
  width: min(860px, 94vw);
  border-radius: 26px;
  background: rgba(255,255,255,0.88);
  border: 1px solid rgba(0,0,0,0.08);
  box-shadow: var(--convo-shadow);
  padding: 26px 24px;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

/* Intro: LIGHT frosted glass (keeps sheen + blur, not dark) */
#convoApp[data-mode="intro"] .lux-heroCard{
  width: min(820px, 92vw);
  min-height: 420px;
  padding: 56px 54px 46px;
  border-radius: 38px;
  text-align: center;

  /* Center the hero content (vertical + horizontal) */
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 18px;

  /* slightly “milkier” glass helps the depth read */
  background: rgba(255,255,255,0.60);
  border: 1px solid rgba(0,0,0,0.10);

  /* pillowy depth + double border trick (outer rim + inner hairline) */
  box-shadow:
    0 32px 80px rgba(0,0,0,0.18),              /* main lift */
    0 10px 26px rgba(0,0,0,0.10),              /* near shadow */
    0 0 0 1px rgba(0,0,0,0.06),                /* subtle outer rim */
    inset 0 0 0 1px rgba(255,255,255,0.42),    /* hairline inner border */
    inset 0 1px 0 rgba(255,255,255,0.55),      /* top inner highlight */
    inset 0 -10px 24px rgba(0,0,0,0.06);       /* bottom inner depth */

  /* crisp rounded edge (helps it “read” as a thick card) */
  outline: 1px solid rgba(255,255,255,0.35);
  outline-offset: -1px;

  -webkit-backdrop-filter: blur(18px) saturate(1.18);
  backdrop-filter: blur(18px) saturate(1.18);
}

/* Ensure hero content stays above the glass pseudo-elements */
#convoApp[data-mode="intro"] .lux-heroCard > *{
  position: relative;
  z-index: 2;
}

/* Soft internal “glass lighting” */
#convoApp[data-mode="intro"] .lux-heroCard::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius: inherit;
  pointer-events:none;
  background:
    radial-gradient(circle at 22% 18%, rgba(255,255,255,0.14), rgba(255,255,255,0) 58%),
    radial-gradient(circle at 78% 68%, rgba(255,255,255,0.08), rgba(255,255,255,0) 55%);
}

/* Diagonal sheen sweep (every few seconds) */
#convoApp[data-mode="intro"] .lux-heroCard::after{
  content:"";
  position:absolute;
  inset:-40%;
  pointer-events:none;
  background: linear-gradient(115deg,
    rgba(255,255,255,0) 42%,
    rgba(255,255,255,0.28) 50%,
    rgba(255,255,255,0) 58%);
  transform: translateX(-120%);
  opacity: 0;
  animation: luxHeroSheen 6.8s ease-in-out infinite;
  mix-blend-mode: overlay;
}

@keyframes luxHeroSheen{
  0%,72%{ transform: translateX(-120%); opacity: 0; }
  78%{ opacity: 0.85; }
  100%{ transform: translateX(120%); opacity: 0; }
}

.lux-heroBrand{
  font-size: 13px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: rgba(0,0,0,0.55);
}
#convoApp[data-mode="intro"] .lux-heroBrand{
  color: rgba(0,0,0,0.58);
}

.lux-heroTitle{
  font-size: 38px;
  font-weight: 860;
  margin-top: 10px;
  color: var(--convo-ink);
}
#convoApp[data-mode="intro"] .lux-heroTitle{
  color: var(--convo-ink);
  font-size: 58px;
  line-height: 1.06;
  margin-top: 0;
}

.lux-heroSub{
  margin-top: 12px;
  font-size: 15px;
  color: rgba(0,0,0,0.62);
  line-height: 1.45;
  max-width: 70ch;
}
#convoApp[data-mode="intro"] .lux-heroSub{
  color: rgba(0,0,0,0.62);
  font-size: 22px;   /* bigger body copy */
  line-height: 1.55;
  max-width: 60ch;
  margin-top: 0;
  margin-left: auto;
  margin-right: auto;
}

/* Timed underline “draw” effect (intro hero only) */
#convoApp[data-mode="intro"] .lux-uline{
  --u-color: var(--lux-blue-primary);
  --u-thickness: 3px;
  --u-delay: 1.1s;
  display: inline-block;
  padding-bottom: 2px;
  background-image: linear-gradient(var(--u-color), var(--u-color));
  background-repeat: no-repeat;
  background-position: 0 100%;
  background-size: 0% var(--u-thickness);
  animation: luxUnderlineDraw 1.4s ease forwards;
  animation-delay: var(--u-delay);
}
#convoApp[data-mode="intro"] .lux-uline.u2{ --u-delay: 2.6s; }

@keyframes luxUnderlineDraw{
  to { background-size: 100% var(--u-thickness); }
}

@media (prefers-reduced-motion: reduce){
  #convoApp[data-mode="intro"] .lux-uline{
    animation: none;
    background-size: 100% var(--u-thickness);
  }
}

.lux-heroNext{
  margin-top: 18px;
  border: 1px solid rgba(0,0,0,0.10);
  background: rgba(255,255,255,0.70);
  color: var(--convo-ink);
  border-radius: 14px;
  padding: 12px 18px;
  cursor: pointer;
  font-weight: 800;
}
.lux-heroNext:hover{ background: rgba(255,255,255,0.92); }

/* Intro CTA: Lux-style pill (light, not stark) */
#convoApp[data-mode="intro"] .lux-heroNext{
  background: rgba(255,255,255,0.78);
  border: 1px solid rgba(0,0,0,0.12);
  color: var(--convo-ink);
  border-radius: 999px;
  padding: 14px 28px;
  font-size: 17px;
  min-width: 170px;
  box-shadow: 0 12px 26px rgba(0,0,0,0.12);
  margin-top: 0;
}
#convoApp[data-mode="intro"] .lux-heroNext:hover{
  background-color: var(--lux-water-hover, rgba(233,246,255,1));
  border-color: var(--lux-water-border, rgba(0,120,215,0.28));
  box-shadow:
    0 14px 28px rgba(0,0,0,0.12),
    0 0 0 3px var(--lux-water-halo, rgba(0,120,215,0.16));
}

@media (prefers-reduced-motion: reduce){
  #convoApp[data-mode="intro"] .lux-heroCard::after{
    animation: none !important;
    opacity: 0 !important;
  }
}


/* ============================================================
   Deck (scenario picker)
   ============================================================ */
.lux-deck{
  position: relative;
  width: min(980px, 94vw);
  height: min(var(--lux-media-h, 520px), 76vh);
  transform-style: preserve-3d;
}

/* Picker sizing bump */
#convoApp[data-mode="picker"] .lux-deck{
  width: min(1120px, 96vw);
  height: min(780px, 76vh);
}

/* The card adopts the media's NATURAL ratio.
   Height is capped to viewport; width is derived automatically. */
#convoApp[data-mode="picker"] .lux-deck-card{
  height: min(var(--lux-media-h, 520px), 76vh);
  aspect-ratio: var(--lux-media-ar, 16 / 9);
  width: auto;
}
#convoApp[data-mode="picker"] .lux-deckTitle{ font-size: 44px; }
#convoApp[data-mode="picker"] .lux-deckDesc{ font-size: 18px; }
#convoApp[data-mode="picker"] .lux-navArrow,
#convoApp[data-mode="picker"] .lux-navNext{
  font-size: 16px;
  padding: 12px 18px;
}
#convoApp[data-mode="picker"] .lux-navArrow{ min-width: 108px; }

.lux-deck-card{
  position: absolute;
  top: 50%;
  left: 50%;
  /* variable-sized cards must be vertically centered */
  transform: translate(-50%, -50%);

  border-radius: 26px;
  overflow: hidden;
  isolation: isolate;
  background: rgba(255,255,255,0.88);
  border: 1px solid rgba(0,0,0,0.08);
  box-shadow: var(--convo-shadow);

  padding: 18px 18px 16px;
  backdrop-filter: blur(10px);

  transition: transform 520ms cubic-bezier(0.18, 0.9, 0.2, 1),
              filter 520ms cubic-bezier(0.18, 0.9, 0.2, 1),
              opacity 520ms cubic-bezier(0.18, 0.9, 0.2, 1);
}

/* Deck card media layering:
   ::before = soft blurred fill (always)
   ::after  = sharp still “poster” (contain)
   .lux-cardMedia/.lux-cardVideo = video (contain), shown only when playing
*/
.lux-deck-card.has-img::before{
  content:"";
  position:absolute;
  inset:-12%;
  background-image: var(--lux-card-img);
  background-size: cover;
  background-position: center;
  filter: blur(14px) saturate(1.08);
  transform: scale(1.04);
  opacity: 0.28;
  pointer-events: none;
  z-index: 0;
}

.lux-deck-card.has-img::after{
  content:"";
  position:absolute;
  inset: 0;
  background-image: var(--lux-card-img);
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  opacity: 0.92;
  transition: opacity 260ms ease;
  pointer-events: none;
  z-index: 2;
}

/* video layer sits under the sharp still; the still fades out while playing */
.lux-cardMedia{
  position: absolute;
  inset: 0;
  z-index: 1;
  pointer-events: none;
  overflow: hidden;
  border-radius: inherit;
}

.lux-cardVideo{
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: 50% 50%;
  opacity: 0;
  transition: opacity 420ms ease;
}

/* PLAYING: show video, hide sharp still */
.lux-deck-card.has-video[data-vstate="playing"] .lux-cardVideo{ opacity: 0.34; }
.lux-deck-card.has-video[data-vstate="playing"]::after{ opacity: 0; }

/* ENDED/ERROR: hide video, restore sharp still */
.lux-deck-card.has-video[data-vstate="ended"] .lux-cardVideo{ opacity: 0; }
.lux-deck-card.has-video[data-vstate="ended"]::after{ opacity: 0.92; }

.lux-deck-card.has-video[data-vstate="error"] .lux-cardVideo{ opacity: 0; }
.lux-deck-card.has-video[data-vstate="error"]::after{ opacity: 0.92; }

/* text above all media */
.lux-deck-card.has-img > *:not(.lux-cardMedia){
  position: relative;
  z-index: 3;
}

/* ============================================================
   Deck text readability panel (scrim)
   ============================================================ */
.lux-deckText{
  position: relative;
  z-index: 3;
  max-width: min(560px, 78%);
  padding: 16px 18px;
  border-radius: 18px;

  /* dark scrim so white text reads on ANY photo/video */
  background: linear-gradient(135deg,
    rgba(0,0,0,0.64),
    rgba(0,0,0,0.26)
  );

  backdrop-filter: blur(6px);
  box-shadow: 0 14px 28px rgba(0,0,0,0.18);
}

/* Make the pill readable on media */
.lux-deckText .lux-pill{
  color: rgba(255,255,255,0.86);
  background: rgba(255,255,255,0.12);
  border-color: rgba(255,255,255,0.22);
}

/* White text + subtle shadow */
.lux-deckText .lux-deckTitle{
  color: rgba(255,255,255,0.96);
  text-shadow: 0 2px 10px rgba(0,0,0,0.35);
}

.lux-deckText .lux-deckDesc{
  color: rgba(255,255,255,0.84);
  text-shadow: 0 2px 10px rgba(0,0,0,0.28);
}

/* Expand/collapse (taller “fog box” reveal) */
.lux-deckMore{
  margin-top: 10px;
  color: rgba(255,255,255,0.84);
  text-shadow: 0 2px 10px rgba(0,0,0,0.28);

  max-height: 0;
  overflow: hidden;
  opacity: 0;
  transform: translateY(-4px);

  transition:
    max-height 240ms ease,
    opacity 180ms ease,
    transform 240ms ease;
}

.lux-deck-card.isExpanded .lux-deckMore{
  max-height: 240px;
  opacity: 1;
  transform: translateY(0);
}

/* CTA stands out (and is the only "enter" affordance) */
.lux-deckText .lux-deckCta{
  background: rgba(255,255,255,0.92);
  border: 1px solid rgba(255,255,255,0.35);
  color: rgba(0,0,0,0.86);
  box-shadow: 0 12px 20px rgba(0,0,0,0.22);
}
.lux-deckText .lux-deckCta:hover{
  background: rgba(255,255,255,0.98);
}

/* While video is playing, strengthen the scrim a bit */
.lux-deck-card.has-video[data-vstate="playing"] .lux-deckText{
  background: linear-gradient(135deg,
    rgba(0,0,0,0.72),
    rgba(0,0,0,0.32)
  );
}

@media (prefers-reduced-motion: reduce){
  .lux-cardVideo{ display: none !important; }
  .lux-deck-card.has-img::after{ opacity: 0.92 !important; }
}

.lux-deck-card.is-active{
  width: min(660px, 92vw);
  z-index: 3;
  opacity: 1;
  filter: blur(0px);
  cursor: pointer;
}

.lux-deck-card.is-preview{
  width: min(520px, 86vw);
  z-index: 1;
  opacity: 0.62;       /* was 0.55 */
  filter: blur(4.5px); /* was 6px */
  cursor: pointer;
}

/* Overlap + left/right staggering (MORE separation) */
#convoApp[data-side="left"]  .lux-deck-card.is-active { transform: translate(-50%, -50%) translateX(-110px) scale(1.00); }
#convoApp[data-side="left"]  .lux-deck-card.is-preview{ transform: translate(-50%, -50%) translateX(190px)  scale(0.90); }

#convoApp[data-side="right"] .lux-deck-card.is-active { transform: translate(-50%, -50%) translateX(110px)  scale(1.00); }
#convoApp[data-side="right"] .lux-deck-card.is-preview{ transform: translate(-50%, -50%) translateX(-190px) scale(0.90); }

.lux-pill{
  display: inline-flex;
  gap: 8px;
  align-items: center;
  font-size: 12px;
  letter-spacing: 0.10em;
  text-transform: uppercase;

  color: rgba(0,0,0,0.60);
  background: rgba(0,0,0,0.04);
  border: 1px solid rgba(0,0,0,0.08);

  padding: 6px 10px;
  border-radius: 999px;
}

.lux-deckTitle{
  margin-top: 14px;
  font-size: 28px;
  font-weight: 820;
  color: var(--convo-ink);
}

.lux-deckDesc{
  margin-top: 10px;
  font-size: 15px;
  color: rgba(0,0,0,0.62);
  line-height: 1.45;
  max-width: 52ch;
}

.lux-deckCta{
  margin-top: 16px;
  background: rgba(0,120,215,0.10);
  border: 1px solid rgba(0,120,215,0.22);
  color: var(--convo-ink);
  border-radius: 14px;
  padding: 10px 14px;
  cursor: pointer;
  font-weight: 850;
}
.lux-deckCta:hover{ background: rgba(0,120,215,0.14); }

/* =========================================================
   Picker: thumbnail dots (bigger + actual image preview)
   NOTE: Your DOM uses .lux-thumbs + .lux-thumb already.
   This block upgrades them in picker mode (size + cover/center).
========================================================= */

#convoApp[data-mode="picker"] .lux-thumbs{
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  margin-top: 10px;

  /* NEW: prevent wrap intrusion; make it a horizontal strip */
  flex-wrap: nowrap;
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;

  width: min(980px, 94vw);
  max-width: min(980px, 94vw);

  padding: 6px 10px;
  margin: 14px auto 0; /* give it breathing room */
  position: relative;
  z-index: 10;
}

/* base “dot” becomes a tiny thumbnail */
#convoApp[data-mode="picker"] .lux-thumb{
  width: 28px;              /* bigger than circles, still small */
  height: 18px;
  border-radius: 6px;

  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;

  border: 1px solid rgba(0,0,0,0.10);
  box-shadow: 0 8px 18px rgba(0,0,0,0.10);

  opacity: 0.70;
  transform: translateY(0);
  transition: transform 160ms ease, opacity 160ms ease, box-shadow 160ms ease;
  cursor: pointer;

  /* NEW: keep each thumb from shrinking/wrapping */
  flex: 0 0 auto;
}

/* keep non-image fallback readable (single letter) */
#convoApp[data-mode="picker"] .lux-thumb:not(.has-img){
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  line-height: 1;
}

#convoApp[data-mode="picker"] .lux-thumb:hover{
  opacity: 0.95;
  transform: translateY(-1px) scale(1.04);
  box-shadow: 0 10px 22px rgba(0,0,0,0.12);
}

#convoApp[data-mode="picker"] .lux-thumb.is-active{
  opacity: 1;
  border-color: rgba(0,120,215,0.45);
  box-shadow:
    0 12px 26px rgba(0,0,0,0.14),
    0 0 0 3px rgba(0,120,215,0.18);
}

/* Picker nav row (Back / Next) */
#convoApp[data-mode="picker"] .lux-navrow{
  width: min(980px, 94vw);
  margin: 14px auto 0;
  display:flex;
  justify-content: space-between;
  align-items:center;
  position: relative;
  z-index: 20;
}

#convoApp[data-mode="picker"] .lux-navbtn{
  min-width: 110px;
  text-align: center;
}

/* Thumbnails */
.lux-thumbs{
  width: min(980px, 94vw);
  display: flex;
  justify-content: center;
  gap: 8px;
  flex-wrap: wrap;
  padding: 2px 4px;
}
.lux-thumb{
  width: 16px;
  height: 16px;
  border-radius: 999px;
  border: 1px solid rgba(0,0,0,0.14);
  background: rgba(255,255,255,0.70);
  color: rgba(0,0,0,0.70);

  font-size: 10px;
  line-height: 14px;
  text-align: center;

  cursor: pointer;
  padding: 0;
}
.lux-thumb.is-active{
  background: rgba(0,120,215,0.14);
  border-color: rgba(0,120,215,0.35);
}

/* Deck nav */
.lux-deckNav{
  width: min(980px, 94vw);
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  margin-top: 4px;
}
.lux-navArrow,
.lux-navNext{
  border-radius: 14px;
  padding: 10px 14px;
  border: 1px solid rgba(0,0,0,0.10);
  background: rgba(255,255,255,0.70);
  color: var(--convo-ink);
  cursor: pointer;
  font-weight: 850;
}
.lux-navArrow:hover,
.lux-navNext:hover{ background: rgba(255,255,255,0.92); }
