/* lux-widgets.record-viz.css */
/* Record button states + mic visualizer bars */

/* ============================================================
   Record button: Live Mic Level Viz (equalizer bars)
   ============================================================ */

/* Keep button stable + allow overlay visuals */
#record {
  position: relative;
  overflow: hidden;
}

/* Label sits above everything */
#record .lux-recLabel{
  position: relative;
  z-index: 2;
}

/* Equalizer overlay */
#record .lux-recViz{
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 3px;
  z-index: 3;
  pointer-events: none;
  opacity: 0;
  transform: scale(0.98);
  transition: opacity 0.18s ease, transform 0.18s ease;
}

/* Show the viz only once we’re in the amber “record-glow” phase */
#record.record-glow .lux-recViz,
#record.record-glow:disabled .lux-recViz{
  opacity: 1;
  transform: scale(1);
  transition-delay: 0.82s; /* waits for your green intro stripe to finish */
}

/* Hide label + mic emoji while recording (keeps button width stable) */
#record.record-glow .lux-recLabel,
#record.record-glow:disabled .lux-recLabel,
#record.record-glow::before,
#record.record-glow:disabled::before{
  opacity: 0;
}

/* Individual bars */
#record .lux-recBar{
  width: 4px;
  height: 18px;
  border-radius: 3px;
  background: currentColor;
  opacity: 0.72;
  transform-origin: center bottom;
  transform: scaleY(var(--y, 0.12));
  will-change: transform;
}

@media (prefers-reduced-motion: reduce) {
  #record .lux-recViz { transition: none; }
}

/* ============================================================
   Record button intro stripe sweep
   ============================================================ */
#record.record-intro::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: repeating-linear-gradient(
    135deg,
    var(--stripe-green-1) 0 10px,
    var(--stripe-green-2) 10px 20px
  );
  background-size: 220% 100%;
  animation: recordSlashGreen 0.8s ease-out forwards;
  pointer-events: none;
}

@keyframes recordSlashGreen {
  from { background-position: -220% 0; opacity: 1; }
  90% { background-position: 0 0; opacity: 1; }
  to { background-position: 0 0; opacity: 0; }
}

/* ============================================================
   Record button glow loop (amber pulse)
   ============================================================ */
#record.record-glow,
#record.record-glow:disabled {
  animation: recordGlowAmber 1.6s ease-in-out infinite;
  box-shadow: 0 0 0 0 var(--rec-glow-soft), 0 0 20px var(--rec-glow-soft);
  filter: brightness(1);
}

@keyframes recordGlowAmber {
  0% {
    box-shadow: 0 0 0 0 var(--rec-glow-soft), 0 0 20px var(--rec-glow-soft);
    filter: brightness(1);
  }
  50% {
    box-shadow: 0 0 0 16px rgba(234, 179, 8, 0), 0 0 38px var(--rec-glow-strong);
    filter: brightness(1.14);
  }
  100% {
    box-shadow: 0 0 0 0 var(--rec-glow-soft), 0 0 20px var(--rec-glow-soft);
    filter: brightness(1);
  }
}

@media (prefers-reduced-motion: reduce) {
  #record.record-glow { animation: none; }
}
